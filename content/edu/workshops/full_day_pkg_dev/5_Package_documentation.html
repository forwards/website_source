<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Documentation</title>
    <meta charset="utf-8" />
    <meta name="author" content="Forwards Teaching Team" />
    <link href="libs/font-awesome/css/fontawesome-all.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="..\..\libs\remark-css\default.css" type="text/css" />
    <link rel="stylesheet" href="..\..\libs\forwards.css" type="text/css" />
    <link rel="stylesheet" href="..\..\libs\forwards-fonts.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Documentation
### Forwards Teaching Team<br><br><img src='../../pics/forwards_296x296.png' alt='Forwards logo' width='100'>
### <br><i class="fab  fa-twitter "></i> <a href="https://twitter.com/R_Forwards">@R_Forwards</a><br><a href="https://forwards.github.io/" class="uri">https://forwards.github.io/</a>
### <br> updated: 2020-03-05

---




class: clear font200

.pull-left[
.center[
Function-level with roxygen2
&lt;img src="../../pics/function_level_doc.png" height="500px" /&gt;
]
]

.pull-right[
.center[
Package-level with rmarkdown
&lt;img src="../../pics/package_level_doc.png" height="500px" /&gt;
]
]

---

class: inverse center middle font200

# Markdown

Quick overview

---

class: clear font200

# Basic markdown formatting

&lt;pre&gt;
# This is a top level heading

This is some text. Make text _italic_ with single underscores
(or stars). Make it **bold** with double stars (or underscores).
Here is a [link to a markdown guide](http://bit.ly/19fAexE).

* This is a list
* This is another item

```R
# Some R code
f &lt;- function() x + 1
```

## This is a secondary heading
&lt;/pre&gt;

---

class: clear font200

You can also do inline code, numbered lists and quotes and
more.

&lt;img src="../../pics/markdown_quick_reference.png" width="500px" /&gt;

---

class: inverse center middle font200

# Markdown

Function documentation with **roxygen2**

---

class: clear center font200

## Roxygen2

&lt;img src="../../pics/roxygen_flow.png" width="900px" /&gt;

http://r-pkgs.had.co.nz/man.html

---

class: clear font200

## You write specially formatted comments in .R

```r
#' @param x A numeric vector.
```

`#'` denotes a Roxygen comment

`@param` is a Roxygen tag. 

The `@param` tag takes an argument: the name of the parameter

The remaining text (until the next tag in the file ) is the documentation 
relevant to the tag.

---

class: clear font160

## The full manual page can be created this way

```r
#' Sort a Numeric Vector in Decreasing Order
#'
#' Sort a numeric vector so that the values are in deceasing order.  Missing
#' values are optionally removed or put last.
#'
#' @param x A numeric vector.
#' @param na.rm A logical value indicating whether to remove missing values
#' before sorting.
#' @return A vector with the values sorted in descreasing order.
#' @export
#'
#' @examples
#' x &lt;- c(3, 7, 2, NA)
#' high_to_low(x)
#' high_to_low(x, na.rm = TRUE)
```
---

class: clear font160

## Roxygen translates to **.Rd** - but you can ignore this file!

&lt;pre&gt;
% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/high_to_low.R
\name{high_to_low}
\alias{high_to_low}
\title{Sort a Numeric Vector in Decreasing Order}
\usage{
high_to_low(x, na.rm = FALSE)
}
\arguments{
\item{x}{A numeric vector.}
\item{na.rm}{A logical value indicating whether to remove missing values
before sorting.}
}
\value{
...
&lt;/pre&gt;

---

class: clear center

&lt;img src="../../pics/high_to_low.png" width="700px" /&gt;

---

class: clear font200

## Documentation workflow


&lt;img src="../../pics/documentation_workflow.png" width="800px" /&gt;

---

class: clear font200

## Two caveats

1. You must have loaded the package with
`load_all()` at least once.
    - Check for message "Using development documentation..."
    
2. This technique only builds individual files so links do not work.

---

class: clear font200

## RStudio helps you get started

.pull-left[
&lt;img src="../../pics/roxygen_skeleton.png" width="500px" /&gt;
]

.pull-right[

```r
#' Title
#'
#' @param x
#' @param y
#' @param z
#'
#' @return
#' @export
#'
#' @examples
fun &lt;- function(x, y, z) {
}
```
]

---

class: font200

# Your turn

Open the `animalSounds.R` file

1. Insert a Roxygen skeleton using the RStudio helper.
2. Create a draft documentation file with `devtools::document()` or 
`Cmd/Ctrl + Shift + D`.
3. Preview the help with `?animalSounds`.

---

class: clear font200

## The description block

- First sentence is the **title**
- Next paragraph is the **description**
- Everything else is the **details** (optional)

```
#' Sort a Numeric Vector in Decreasing Order
#'
#' \code{high_to_low} sorts the values of a numeric vector in 
#' decreasing order.
#'
#' This is a convenience function that is a wrapper around 
#' \code{\link{sort.int}}.
```

---

class: clear font200

&lt;img src="../../pics/low_to_high.png" width="800px" /&gt;

???

See where the title, description and details end up!


---

class: clear font200

There are five *tags* youâ€™ll use for most functions

Tag        | Purpose
---------- | -------------
@param arg | Describe inputs
@examples  | Show how the function works
@seealso   | Pointers to related functions
@return    | Describe outputs (value)
@export    | Is this a user-visible function?


Usual RStudio shortcuts work in the @examples section

---

class: font200

# Your turn

1. Fill in the title and description for `animalSounds()`.
2. Re-create the documentation.
3. Preview the help file to see your changes.
4. If you have time, fill in the return value and add one or more examples.

---

class: clear font200

## Use markdown for formatting

Activate by running `use_roxygen_md()`

Text formatting: `**bold**`, `_italic_`, `` `code` ``

Create links

* To a function in the same package: `[func()]`
* To a function in a different package: `[pkg::func()]`

With different link text, e.g. `[link text][func()]`

`

---

class: clear font200

## Documentation workflow 2

&lt;img src="../../pics/documentation_workflow2.png" width="700px" /&gt;

---

class: font200

# Your turn

1. Activate markdown formatting on your package.
2. Add some details to the help package for `animalSounds()`, with a link to 
`paste0()`.
3. Create the documentation with the second workflow and look at the help file. 
Does the link to `paste0()` work?

---

class: clear font200

## roxygen2 comes with other tools to reduce duplication

Document multiple functions in the same file
```r
#' @rdname add_col
```

Inherit the parameter descriptions from another function
```r
#' @inheritParams add_col
```

---

class: clear font200

## roxygen2 comes with other tools to reduce duplication

Inherit everything from another topic
```r
#' @inherit add_col
```

Inherit selectively

```r
#' @inherit add_col parameters return references
#'   title description details
#'   sections seealso
```

---

class: clear font200

## Read online about how to document other objects

* Data: http://r-pkgs.had.co.nz/data.html#documenting-data

* Classes &amp; methods: http://r-pkgs.had.co.nz/man.html#man-classes

* Package as a whole: http://r-pkgs.had.co.nz/man.html#man-packages

---

class: inverse center middle font200

# Markdown

Package documentation with `rmarkdown`

---

class: clear font200

## Vignettes

.pull-left[
&lt;img src="../../pics/vignette_creation.png" height="500px" /&gt;
]
.pull-right[
Lets you combine prose
and code to explain your
how you package works.

The hard part is the
writing, not the
technology!
]

http://r-pkgs.had.co.nz/vignettes.html

---

class: clear font200

## Easiest way to get started is with `use_vignette()`

```r
usethis::use_vignette("name")
```

Adds to DESCRIPTION

&lt;pre&gt;
Suggests: knitr
VignetteBuilder: knitr
&lt;/pre&gt;

Creates `vignettes/`

Drafts `vignettes/name.Rmd`

---

class: clear font200

## Vignette = Rmarkdown + special metadata

```

---
title: "Vignette Title"
author: "Vignette author"
date: "2020-03-05"
output: rmarkdown::html_vignette
vignette: &gt;
%\VignetteIndexEntry{Vignette Title}
%\VignetteEngine{knitr::rmarkdown}
%\VignetteEncoding{UTF-8}
---

```

---

class: clear font200

* `html_vignette` output uses a custom style sheet to keep the file size of the 
HTML as small as possible.

* The `vignette:` field contains special metadata needed when the package is 
built. **Don't forget to change the title here too!**

---

class: clear center

# Vignette workflow

&lt;img src="../../pics/vignette_workflow.png" width="900px" /&gt;

---

class: font200

# Your turn

1. Install your **animalSounds** package and restart R 
(Install &amp; Restart button).
2. Create a simple vignette that shows how to use `animalSounds()`.
3. Fix the "vignette title".
4. Knit the vignette to preview it.

---

class: inverse center middle

# README

---

class: clear font200

## If sharing with others, include a README

** usethis** has functions to set up a README with/without R code

```r
usethis::use_readme_rmd()
usethis::use_readme_md()
```

For public projects this should include 
 - a brief overview
 - instructions on how to install the package
 - a few examples
 
For private projects, this is a great place to jot down notes.

---

class: inverse center middle

# NEWS

---

class: clear font200

# Also good idea to track changes


```r
usethis::use_news_md()
```

Add news for the latest version at the top.

Use a top-level heading for each release version

```r
# mypackage 1.0.0
```

---

class: clear font200

## What news to include

Add each change in a bulleted list
 - If you have many changes, split into subsections (e.g.
    `## Major changes`, `## Minor improvements`, `## Bug fixes`).
 - Wait until release to decide if subsections are necessary
 
Note connections to GitHub
 - If related to a GitHub issue, add the issue number, e.g. (`#10`). 
 - If related to a pull request, add the pull request number and the author, e.g. (`#101, @hadley`). 
 
---

class: inverse center middle

# Package website with `pkgdown`

---

class: clear font200

## Build a website

`pkgdown::build_site()` creates a package website based on the 
standard documentation files.

**Home page**: based on README

**Reference**: 
 - one page for help file
 - generates an index page, with functions listed alphabetically by default

---

class: clear font200  

**Articles**: one page for each vignette

**Get Started**: if you have a vignette with filename = package name

**News**

A link to your GitHub repo (if listed in the DESCRIPTION url field).

---

class: font200  

# Your turn

1. Install pkgdown 

2. Run `pkgdown::build_site()` to creat a website for your package!

---

class: clear font200  

## Publishing the **pkgdown** website

You can publish the website using GitHub.

See the **pkgdown** "Introduction to pkgdown" vignette for further details.

---

class: clear font200

## License

&lt;a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"&gt;&lt;img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" /&gt;&lt;/a&gt;&lt;br /&gt;&lt;span xmlns:dct="http://purl.org/dc/terms/" property="dct:title"&gt;Package Development Workshop&lt;/span&gt; by &lt;span xmlns:cc="http://creativecommons.org/ns#" property="cc:attributionName"&gt;Forwards&lt;/span&gt; is licensed under a &lt;a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"&gt;Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License&lt;/a&gt;.
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="../../libs/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": false,
"countIncrementalSlides": true,
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();</script>

<script>
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
